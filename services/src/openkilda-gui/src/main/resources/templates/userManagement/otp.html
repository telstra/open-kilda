<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml"
   xmlns:th="http://www.thymeleaf.org"
   xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
   <head>
      <meta charset="utf-8">
      </meta>
      <title>OPEN KILDA</title>
      <!-- CSS Style Sheets -->
      <link th:href="@{css/jquery.dataTables.min.css}" rel="stylesheet"
         type="text/css" />
      <link href="css/multi-select.css" rel="stylesheet" type="text/css"/>
      <link href="css/select2.min.css" rel="stylesheet" type="text/css"/>
      <link th:href="@{images/kilda.png}" rel="shortcut icon" type="image/png"/>
      
   </head>
   <body>
      <div th:include="fragments/importResources:: commonImports"></div>
      <div class="login-wrapper">
			
		<div class="login">
			<div class="col-lg-12">
				<form name="form" method="POST" th:action="@{authenticate}">
					<h1 class="text-center">Open Kilda</h1>
					<h2 class="text-center">Two-factor authentication</h2>
					<input type="hidden" name="username" id="username" th:value="${username}" style="visibility:hidden;"/>
					<input type="hidden" name="password" id="password" th:value="${password}" style="visibility:hidden;"/>
								
					<div class="form-group">
						<label for="otp">Enter the authentication code <span class="mandatory-text text-danger">*</span></label>
						 <!-- <div class="">
							<input name="code" id="code" type="password" maxlength="6" class="form-control partitioned" placeholder="OTP" onkeyup="removeError(this);" 
							autocomplete="off" autofocus="true"/>
							
						</div>--> 
						 <div class="barcode-bg">					
						<div class="otp otp-container">
						<input name="code" id="code" type="hidden" maxlength="6"  placeholder="OTP"  />
						<input  autofocus="true" class="form-control otpdigit" placeholder="*" maxlength="1" onkeypress="validateOtpFragment()" onkeyup="assembleOtp();removeErrorOtp();" />
						<input class="form-control otpdigit" placeholder="*" maxlength="1"  onkeypress="validateOtpFragment()" onkeyup="assembleOtp();removeErrorOtp();"/>
						<input class="form-control otpdigit" placeholder="*" maxlength="1" onkeypress="validateOtpFragment()"  onkeyup="assembleOtp();removeErrorOtp();"/>
						<input class="form-control otpdigit" placeholder="*" maxlength="1"  onkeypress="validateOtpFragment()" onkeyup="assembleOtp();removeErrorOtp();"/>
						<input class="form-control otpdigit" placeholder="*" maxlength="1"  onkeypress="validateOtpFragment()" onkeyup="assembleOtp();removeErrorOtp();"/>
						<input class="form-control otpdigit" placeholder="*" maxlength="1" onkeypress="validateOtpFragment()"  onkeyup="assembleOtp();removeErrorOtp();"/> 
						</div>    
					</div> 
						<span id="codeError" style="display:none; color:red;">Authentication code is required.</span>
						<span id="otpError" class="error" style="color:red;" th:text="${error}"></span>
					</div>
					<div class="form-group">
						<button type="submit" class="btn btn-md btn-primary btn-submit">Verify</button>
					</div>		
					<p class="icons-phone">Open the two-factor authentication app on your device to view your authentication code and verify your identity.</p>	
				</form>
			</div>
		</div>
	</div>
      <script th:inline="javascript" src="javascript/common.js" th:src="@{javascript/common.js}"></script>
      <script th:inline="javascript" src="javascript/userManagement/twofa.js"></script>
      <div th:replace="fragments/footer :: footer"></div>

   </body>
</html>